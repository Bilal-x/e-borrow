<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Item Details - E-Borrow</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="styles.css" rel="stylesheet">
    <style>
        .detail-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 100px 20px 2rem;
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 3rem;
        }

        .detail-main {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .image-gallery {
            position: relative;
            height: 400px;
            background: var(--gray-light);
        }

        .main-image {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--secondary), var(--primary));
        }

        .main-image i {
            font-size: 6rem;
            color: var(--white);
        }

        .image-nav {
            position: absolute;
            bottom: 1rem;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 0.5rem;
        }

        .image-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            cursor: pointer;
        }

        .image-dot.active {
            background: var(--white);
        }

        .detail-content {
            padding: 2rem;
        }

        .item-title {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .item-meta {
            display: flex;
            align-items: center;
            gap: 2rem;
            margin-bottom: 1.5rem;
            color: var(--gray-dark);
        }

        .item-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .item-rating i {
            color: var(--accent);
        }

        .item-location {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .item-description {
            line-height: 1.6;
            margin-bottom: 2rem;
        }

        .item-features {
            margin-bottom: 2rem;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            background: var(--gray-light);
            border-radius: var(--border-radius-sm);
        }

        .feature-item i {
            color: var(--primary);
        }

        .owner-section {
            border-top: 1px solid var(--gray-medium);
            padding-top: 2rem;
        }

        .owner-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .owner-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 1.5rem;
        }

        .owner-details h4 {
            margin-bottom: 0.25rem;
        }

        .owner-stats {
            display: flex;
            gap: 1rem;
            color: var(--gray-dark);
            font-size: 0.875rem;
        }

        .owner-avatar-img {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
        }

        .booking-card {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 2rem;
            position: sticky;
            top: 100px;
            height: fit-content;
        }

        .price-display {
            text-align: center;
            margin-bottom: 2rem;
        }

        .price-main {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--accent);
        }

        .price-period {
            color: var(--gray-dark);
            font-size: 1rem;
        }

        .price-options {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: 2rem;
            font-size: 0.875rem;
            color: var(--gray-dark);
        }

        .booking-form {
            margin-bottom: 2rem;
        }

        .date-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .booking-summary {
            background: var(--gray-light);
            padding: 1rem;
            border-radius: var(--border-radius-sm);
            margin-bottom: 1rem;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .summary-total {
            font-weight: 600;
            border-top: 1px solid var(--gray-medium);
            padding-top: 0.5rem;
        }

        .contact-buttons {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .reviews-section {
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid var(--gray-medium);
        }

        .review-item {
            padding: 1.5rem;
            border: 1px solid var(--gray-medium);
            border-radius: var(--border-radius-sm);
            margin-bottom: 1rem;
        }

        .review-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .review-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
        }

        .review-meta {
            flex: 1;
        }

        .review-rating {
            color: var(--accent);
        }

        .review-date {
            color: var(--gray-dark);
            font-size: 0.875rem;
        }

        @media (max-width: 768px) {
            .detail-container {
                grid-template-columns: 1fr;
                gap: 2rem;
                padding: 80px 15px 2rem;
            }

            .booking-card {
                position: static;
            }

            .date-row {
                grid-template-columns: 1fr;
            }

            .item-meta {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .features-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="index.html">
                    <i class="fas fa-exchange-alt"></i>
                    E-Borrow
                </a>
            </div>
            <div class="nav-menu" id="nav-menu">
                <a href="index.html" class="nav-link">Home</a>
                <a href="search.html" class="nav-link">Browse</a>
                <a href="post-item.html" class="nav-link">List Item</a>
                <a href="dashboard.html" class="nav-link">Dashboard</a>
                <a href="login.html" class="nav-link">Login</a>
            </div>
            <div class="nav-toggle" id="nav-toggle">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Detail Container -->
    <div class="detail-container">
        <!-- Main Content -->
        <div class="detail-main">
            <!-- Image Gallery -->
            <div class="image-gallery">
                <div class="main-image" id="main-image">
                    <i class="fas fa-camera"></i>
                </div>
                <div class="image-nav">
                    <div class="image-dot active"></div>
                    <div class="image-dot"></div>
                    <div class="image-dot"></div>
                </div>
            </div>

            <!-- Content -->
            <div class="detail-content">
                <h1 class="item-title" id="item-title">Canon EOS R5</h1>
                
                <div class="item-meta">
                    <div class="item-rating">
                        <i class="fas fa-star"></i>
                        <span id="item-rating">4.9 (23 reviews)</span>
                    </div>
                    <div class="item-location">
                        <i class="fas fa-map-marker-alt"></i>
                        <span id="item-location">San Francisco, CA</span>
                    </div>
                    <div class="item-category">
                        <i class="fas fa-tag"></i>
                        <span id="item-category">Photography</span>
                    </div>
                </div>

                <div class="item-description" id="item-description">
                    <p>Professional mirrorless camera perfect for photography and videography. This Canon EOS R5 features a 45MP full-frame sensor, 8K video recording, and advanced autofocus system. Ideal for professional photographers, content creators, and enthusiasts.</p>
                </div>

                <div class="item-features">
                    <h3>Features & Specifications</h3>
                    <div class="features-grid">
                        <div class="feature-item">
                            <i class="fas fa-camera"></i>
                            <span>45MP Full-Frame Sensor</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-video"></i>
                            <span>8K Video Recording</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-bolt"></i>
                            <span>20fps Burst Mode</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-wifi"></i>
                            <span>Built-in WiFi & Bluetooth</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-shield-alt"></i>
                            <span>Weather Sealed</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-battery-full"></i>
                            <span>Extended Battery Life</span>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Owner Section -->
                <div class="owner-section">
                    <h3>Meet Your Host</h3>
                    <div class="owner-badges">
                        <span class="verification-badge"><i class="fas fa-check-circle"></i> ID Verified</span>
                        <span class="verification-badge"><i class="fas fa-shield-alt"></i> Trusted Renter</span>
                    </div>
                    <div class="owner-info">
                        <div class="owner-avatar">
                            <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Owner" class="owner-avatar-img">
                        </div>
                        <div class="owner-details">
                            <h4 id="owner-name">John Doe</h4>
                            <div class="owner-stats">
                                <span><i class="fas fa-star"></i> 4.9 rating</span>
                                <span><i class="fas fa-box"></i> 12 items</span>
                                <span><i class="fas fa-calendar"></i> Joined 2022</span>
                            </div>
                        </div>
                    </div>
                    <p>Professional photographer with over 10 years of experience. I take great care of my equipment and ensure everything is in perfect condition for renters.</p>
                </div>

                <!-- Reviews Section -->
                <div class="reviews-section">
                    <h3>Reviews (23)</h3>
                    
                    <div class="review-item">
                        <div class="review-header">
                            <div class="review-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="review-meta">
                                <h4>Sarah Wilson</h4>
                                <div class="review-rating">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="review-date">2 weeks ago</div>
                            </div>
                        </div>
                        <p>Amazing camera! John was very helpful and the equipment was in perfect condition. Highly recommend for any photography project.</p>
                    </div>

                    <div class="review-item">
                        <div class="review-header">
                            <div class="review-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="review-meta">
                                <h4>Mike Johnson</h4>
                                <div class="review-rating">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="review-date">1 month ago</div>
                            </div>
                        </div>
                        <p>Great experience renting from John. The camera worked flawlessly for my wedding shoot. Will definitely rent again!</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Booking Card -->
        <div class="booking-card">
            <div class="price-display">
                <div class="price-main" id="price-display">$35</div>
                <div class="price-period">per day</div>
            </div>

            <div class="price-options">
                <div>Weekly: $210 (save $35)</div>
                <div>Monthly: $875 (save $175)</div>
            </div>

            <div class="booking-form">
                <div class="date-row">
                    <div class="form-group">
                        <label class="form-label">Start Date</label>
                        <input type="date" class="form-input" id="start-date">
                    </div>
                    <div class="form-group">
                        <label class="form-label">End Date</label>
                        <input type="date" class="form-input" id="end-date">
                    </div>
                </div>

                <div class="booking-summary" id="booking-summary" style="display: none;">
                    <div class="summary-row">
                        <span>Daily rate × <span id="days-count">0</span> days</span>
                        <span id="subtotal">$0</span>
                    </div>
                    <div class="summary-row">
                        <span>Service fee</span>
                        <span id="service-fee">$0</span>
                    </div>
                    <div class="summary-row summary-total">
                        <span>Total</span>
                        <span id="total-price">$0</span>
                    </div>
                </div>
            </div>

            <div class="contact-buttons">
                <button class="btn btn-primary" onclick="bookItem()">Book Now</button>
                <button class="btn btn-secondary" onclick="contactOwner()">Message Owner</button>
            </div>

            <div style="text-align: center; margin-top: 1rem; font-size: 0.875rem; color: var(--gray-dark);">
                <i class="fas fa-shield-alt"></i>
                Protected by E-Borrow insurance
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        let currentItem = null;

        document.addEventListener('DOMContentLoaded', function() {
            loadItemDetails();
            setupDateCalculation();
        });

        function loadItemDetails() {
            const itemId = localStorage.getItem('selectedListingId');
            if (!itemId) {
                window.location.href = 'search.html';
                return;
            }

            currentItem = dummyListings.find(item => item.id == itemId);
            if (!currentItem) {
                window.location.href = 'search.html';
                return;
            }

            // Update page content
            document.getElementById('item-title').textContent = currentItem.title;
            document.getElementById('item-rating').textContent = `${currentItem.rating} (${currentItem.reviews} reviews)`;
            document.getElementById('item-location').textContent = currentItem.location;
            document.getElementById('item-category').textContent = currentItem.category;
            document.getElementById('item-description').innerHTML = `<p>${currentItem.description}</p>`;
            document.getElementById('owner-name').textContent = currentItem.owner;
            document.getElementById('price-display').textContent = `$${currentItem.price}`;

            // Update main image icon based on category
            const categoryIcons = {
                'Photography': 'fas fa-camera',
                'Vehicles': 'fas fa-car',
                'Tools': 'fas fa-tools',
                'Electronics': 'fas fa-laptop',
                'Sports': 'fas fa-dumbbell',
                'Furniture': 'fas fa-couch'
            };

            const mainImage = document.getElementById('main-image');
            mainImage.innerHTML = `<i class="${categoryIcons[currentItem.category] || 'fas fa-box'}"></i>`;

            // Set minimum date to today
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('start-date').min = today;
            document.getElementById('end-date').min = today;
        }

        function setupDateCalculation() {
            const startDate = document.getElementById('start-date');
            const endDate = document.getElementById('end-date');

            startDate.addEventListener('change', function() {
                endDate.min = this.value;
                calculateTotal();
            });

            endDate.addEventListener('change', calculateTotal);
        }

        function calculateTotal() {
            const startDate = new Date(document.getElementById('start-date').value);
            const endDate = new Date(document.getElementById('end-date').value);
            const summary = document.getElementById('booking-summary');

            if (!startDate || !endDate || endDate <= startDate) {
                summary.style.display = 'none';
                return;
            }

            const days = Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24));
            const dailyRate = currentItem.price;
            const subtotal = days * dailyRate;
            const serviceFee = Math.round(subtotal * 0.1); // 10% service fee
            const total = subtotal + serviceFee;

            document.getElementById('days-count').textContent = days;
            document.getElementById('subtotal').textContent = `$${subtotal}`;
            document.getElementById('service-fee').textContent = `$${serviceFee}`;
            document.getElementById('total-price').textContent = `$${total}`;

            summary.style.display = 'block';
        }

        function bookItem() {
            const user = checkAuth();
            if (!user) {
                alert('Please log in to book an item.');
                window.location.href = 'login.html';
                return;
            }

            const startDate = document.getElementById('start-date').value;
            const endDate = document.getElementById('end-date').value;

            if (!startDate || !endDate) {
                alert('Please select your rental dates.');
                return;
            }

            // Simulate booking
            alert('Booking request sent! The owner will respond within 24 hours.');
        }

        function contactOwner() {
            const user = checkAuth();
            if (!user) {
                alert('Please log in to contact the owner.');
                window.location.href = 'login.html';
                return;
            }

            alert('Message feature would open a chat interface with the owner.');
        }
    </script>
</body>
</html>